<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>ArcGIS Map with Search</title>
  
  <style>
    :root {
      /* CSS HEX */
      --midnight-green: #023c40ff;
      --rosy-brown: #c3979fff;
      --vivid-sky-blue: #0ad3ffff;
      --aquamarine: #78ffd6ff;
      --light-cyan: #e1faf9ff;
    }
    
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      background-color: var(--light-cyan);
    }
    
    .container {
      display: flex;
      height: 100vh;
    }
    
    .sidebar {
      width: 300px;
      background: linear-gradient(135deg, var(--midnight-green), var(--vivid-sky-blue));
      border-right: 3px solid var(--aquamarine);
      display: flex;
      flex-direction: column;
      box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
    }
    
    .header {
      padding: 20px;
      background: var(--midnight-green);
      color: var(--aquamarine);
      text-align: center;
      border-bottom: 2px solid var(--vivid-sky-blue);
    }
    
    .header h1 {
      margin: 0;
      font-size: 18px;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
    }
    
    .controls {
      padding: 20px;
      border-bottom: 2px solid var(--vivid-sky-blue);
      background: rgba(255, 255, 255, 0.1);
    }
    
    .input-group {
      margin-bottom: 15px;
    }
    
    .input-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
      color: var(--aquamarine);
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
    }
    
    .input-group input {
      width: 100%;
      padding: 12px;
      border: 2px solid var(--vivid-sky-blue);
      border-radius: 8px;
      font-size: 14px;
      box-sizing: border-box;
      background: var(--light-cyan);
      color: var(--midnight-green);
      transition: all 0.3s ease;
    }
    
    .input-group input:focus {
      outline: none;
      border-color: var(--aquamarine);
      box-shadow: 0 0 10px rgba(120, 255, 214, 0.5);
    }
    
    .btn {
      width: 100%;
      padding: 12px;
      background: linear-gradient(45deg, var(--vivid-sky-blue), var(--aquamarine));
      color: var(--midnight-green);
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      font-weight: bold;
      margin-bottom: 10px;
      transition: all 0.3s ease;
      text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.3);
    }
    
    .btn:hover {
      background: linear-gradient(45deg, var(--aquamarine), var(--vivid-sky-blue));
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(10, 211, 255, 0.4);
    }
    
    .btn:disabled {
      background: var(--rosy-brown);
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    
    .btn-secondary {
      background: linear-gradient(45deg, var(--rosy-brown), #d4a5a5);
      color: white;
    }
    
    .btn-secondary:hover {
      background: linear-gradient(45deg, #d4a5a5, var(--rosy-brown));
    }
    
    .info-panel {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
      background: rgba(255, 255, 255, 0.05);
    }
    
    .info-item {
      background: rgba(255, 255, 255, 0.9);
      border: 2px solid var(--vivid-sky-blue);
      border-radius: 10px;
      padding: 15px;
      margin-bottom: 15px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      transition: all 0.3s ease;
    }
    
    .info-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
      border-color: var(--aquamarine);
    }
    
    .info-title {
      font-weight: bold;
      margin-bottom: 8px;
      color: var(--midnight-green);
      font-size: 16px;
    }
    
    .info-value {
      color: var(--midnight-green);
      font-size: 14px;
      line-height: 1.4;
    }
    
    .map-container {
      flex: 1;
      position: relative;
      background: var(--light-cyan);
    }
    
    #viewDiv {
      height: 100%;
      width: 100%;
      border-radius: 0;
    }
    
    .status {
      position: absolute;
      top: 15px;
      left: 15px;
      right: 15px;
      padding: 12px;
      border-radius: 8px;
      font-size: 14px;
      z-index: 1000;
      display: none;
      font-weight: bold;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    }
    
    .status.success {
      background: linear-gradient(45deg, var(--aquamarine), var(--vivid-sky-blue));
      color: var(--midnight-green);
      border: 2px solid var(--aquamarine);
    }
    
    .status.error {
      background: linear-gradient(45deg, var(--rosy-brown), #d4a5a5);
      color: white;
      border: 2px solid var(--rosy-brown);
    }
    
    .status.info {
      background: linear-gradient(45deg, var(--vivid-sky-blue), var(--aquamarine));
      color: var(--midnight-green);
      border: 2px solid var(--vivid-sky-blue);
    }
    
    /* Custom scrollbar for info panel */
    .info-panel::-webkit-scrollbar {
      width: 8px;
    }
    
    .info-panel::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 4px;
    }
    
    .info-panel::-webkit-scrollbar-thumb {
      background: linear-gradient(45deg, var(--vivid-sky-blue), var(--aquamarine));
      border-radius: 4px;
    }
    
    .info-panel::-webkit-scrollbar-thumb:hover {
      background: linear-gradient(45deg, var(--aquamarine), var(--vivid-sky-blue));
    }
  </style>
  
  <script>
    var esriConfig = {
      apiKey: "AAPTxy8BH1VEsoebNVZXo8HurHudtAypLm328sIJojSUcoWK4iawKp87GbOMcJ3USNJwbKiZIm2YQTVIk_silIENMrs3wT80o-C9t5-McM9S35_t7YfygIdGEwwNTU1Hw5u4yTu9iaGR0sQgb98joVojRH5bWqquYiXzEIs-wyIVxOzfl2_Iz0ZIre5NJ8Gzb1jfoPILviylmtTC81yrRu3GC1yYbTIplq0E2-JE8SPzLGsO-H8neNEIhpfVs5I2JAOlAT1_VQn5OsAR"
    };
  </script>
  
  <link rel="stylesheet" href="https://js.arcgis.com/4.33/esri/themes/light/main.css">
  <script src="https://js.arcgis.com/4.33/"></script>
</head>

<body>
  <div class="container">
    <div class="sidebar">
      <div class="header">
        <h1>üó∫Ô∏è ArcGIS Map with Search</h1>
      </div>
      
      <div class="controls">
        <div class="input-group">
          <label for="addressInput">Address:</label>
          <input type="text" id="addressInput" placeholder="Enter an address..." />
        </div>
        
        <button id="searchBtn" class="btn">Search Address</button>
        <button id="clearBtn" class="btn btn-secondary">Clear Map</button>
      </div>
      
      <div class="info-panel" id="infoPanel">
        <div class="info-item">
          <div class="info-title">Map Status</div>
          <div class="info-value">Loading map...</div>
        </div>
        <div class="info-item">
          <div class="info-title">Instructions</div>
          <div class="info-value">Enter an address in the input field above and click "Search Address" to find locations on the map.</div>
        </div>
        <div class="info-item">
          <div class="info-title">Test Examples</div>
          <div class="info-value">
            ‚Ä¢ Seattle<br>
            ‚Ä¢ Space Needle<br>
            ‚Ä¢ Hollywood Blvd<br>
            ‚Ä¢ 1600 Pennsylvania Avenue, Washington, DC<br>
            ‚Ä¢ 34.13419, -118.29636
          </div>
        </div>
      </div>
    </div>
    
    <div class="map-container">
      <div id="viewDiv"></div>
      <div id="status" class="status"></div>
    </div>
  </div>

  <script>
    require([
      "esri/Map",
      "esri/views/MapView",
      "esri/widgets/Search",
      "esri/Graphic",
      "esri/geometry/Point",
      "esri/symbols/SimpleMarkerSymbol",
      "esri/symbols/TextSymbol"
    ], function(Map, MapView, Search, Graphic, Point, SimpleMarkerSymbol, TextSymbol) {
      
      // Create the map - following the basic "Display a map" tutorial
      const map = new Map({
        basemap: "streets-vector"
      });
      
      // Create the map view - following the basic tutorial
      const view = new MapView({
        container: "viewDiv",
        map: map,
        center: [-122.3321, 47.6062], // Seattle
        zoom: 12
      });
      
      // Create search widget
      const searchWidget = new Search({
        view: view
      });
      
      // Add search widget to the view
      view.ui.add(searchWidget, "top-right");
      
      // Get DOM elements
      const addressInput = document.getElementById('addressInput');
      const searchBtn = document.getElementById('searchBtn');
      const clearBtn = document.getElementById('clearBtn');
      const infoPanel = document.getElementById('infoPanel');
      const statusDiv = document.getElementById('status');
      
      // Update status function
      function updateStatus(message, type = 'info') {
        statusDiv.textContent = message;
        statusDiv.className = `status ${type}`;
        statusDiv.style.display = 'block';
        
        setTimeout(() => {
          statusDiv.style.display = 'none';
        }, 3000);
      }
      
      // Update info panel
      function updateInfo(title, value) {
        const infoItem = document.createElement('div');
        infoItem.className = 'info-item';
        infoItem.innerHTML = `
          <div class="info-title">${title}</div>
          <div class="info-value">${value}</div>
        `;
        infoPanel.appendChild(infoItem);
      }
      
      // Add marker function
      function addMarker(location, address) {
        // Clear existing graphics
        view.graphics.removeAll();
        
        // Create point geometry
        const point = new Point({
          longitude: location.longitude,
          latitude: location.latitude
        });
        
        // Create marker symbol with custom colors
        const markerSymbol = new SimpleMarkerSymbol({
          color: [2, 60, 64, 0.9], // midnight-green with transparency
          size: 16,
          outline: {
            color: [120, 255, 214], // aquamarine
            width: 3
          }
        });
        
        // Create text symbol with custom colors
        const textSymbol = new TextSymbol({
          color: [120, 255, 214], // aquamarine
          text: 'üìç',
          font: {
            size: 16,
            weight: 'bold'
          },
          haloColor: [2, 60, 64], // midnight-green
          haloSize: 2,
          yoffset: -20
        });
        
        // Create graphics
        const markerGraphic = new Graphic({
          geometry: point,
          symbol: markerSymbol
        });
        
        const textGraphic = new Graphic({
          geometry: point,
          symbol: textSymbol
        });
        
        // Add graphics to view
        view.graphics.add(markerGraphic);
        view.graphics.add(textGraphic);
        
        // Update info panel
        updateInfo('Last Searched', `Address: ${address}<br>Coordinates: ${location.longitude.toFixed(4)}, ${location.latitude.toFixed(4)}`);
      }
      
      // Search function
      async function searchAddress() {
        const address = addressInput.value.trim();
        
        if (!address) {
          updateStatus('Please enter an address.', 'error');
          return;
        }
        
        try {
          updateStatus('Searching address...', 'info');
          searchBtn.disabled = true;
          searchBtn.textContent = 'Searching...';
          
          // Use the search widget to search
          const searchResult = await searchWidget.search(address);
          
          if (searchResult && searchResult.results && searchResult.results.length > 0) {
            const result = searchResult.results[0];
            const location = {
              longitude: result.extent.xmin + (result.extent.xmax - result.extent.xmin) / 2,
              latitude: result.extent.ymin + (result.extent.ymax - result.extent.ymin) / 2
            };
            
            // Add marker
            addMarker(location, address);
            
            updateStatus(`Found: ${result.name}`, 'success');
          } else {
            updateStatus('Address not found. Please try a different address.', 'error');
          }
          
        } catch (error) {
          console.error('Search error:', error);
          updateStatus('Search failed. Please try again.', 'error');
        } finally {
          searchBtn.disabled = false;
          searchBtn.textContent = 'Search Address';
        }
      }
      
      // Clear map
      function clearMap() {
        view.graphics.removeAll();
        addressInput.value = '';
        updateStatus('Map cleared', 'success');
        
        // Clear info panel except first three items
        const items = infoPanel.querySelectorAll('.info-item');
        for (let i = 3; i < items.length; i++) {
          items[i].remove();
        }
      }
      
      // Event listeners
      searchBtn.addEventListener('click', searchAddress);
      clearBtn.addEventListener('click', clearMap);
      
      addressInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
          searchAddress();
        }
      });
      
      // Wait for view to be ready
      view.when(() => {
        // Update status when map is loaded
        updateStatus('Map loaded successfully! Search box is in the top-right corner.', 'success');
        
        // Update info panel
        const statusItem = infoPanel.querySelector('.info-item');
        if (statusItem) {
          statusItem.querySelector('.info-value').textContent = 'Ready to use';
        }
        
        console.log('Map view is ready!');
        console.log('Search widget added to top-right position');
        
      }).catch((error) => {
        console.error('Error loading map view:', error);
        updateStatus('Error loading map', 'error');
      });
      
    });
  </script>
</body>
</html>
